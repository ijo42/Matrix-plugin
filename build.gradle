import proguard.gradle.ProGuardTask

buildscript {
    repositories {
        flatDir dirs: 'libs/proguard6.2.2/lib'
    }
    dependencies {
        classpath ':proguard:'
    }
}
apply plugin: "java"

version '1.0'

sourceCompatibility = 1.8

repositories{
    jcenter()
    mavenCentral()
    maven{ url 'https://www.jitpack.io' }
}

ext{
    //the build number that this plugin is made for
    mindustryVersion = 'v104.6'
}

dependencies{
    compileOnly "com.github.Anuken.Arc:arc-core:$mindustryVersion"
    compileOnly "com.github.fuzzbuck.Mindustry:core:launchpadFix"
    compile 'com.discord4j:discord4j-core:3.1.0.M2'
}

jar{
    from{
        configurations.runtimeClasspath.collect{it.isDirectory() ? it : zipTree(it)}
        configurations
                .compile
                .findAll { !it.name.endsWith('pom') }
                .collect { it.isDirectory() ? it : zipTree(it) }
    }
}

task proguard(type: ProGuardTask) {
    configuration 'proguard.txt'

    injars 'build/libs/Matrix-plugin-1.0.jar'
    outjars 'build/libs/Matrix-plugin-1.0.out.jar'
}

//jar.dependsOn proguard
defaultTasks 'build'